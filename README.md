{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#Dependencies\n",
    "\n",
    "import pandas as pd\n",
    "import os\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Create a reference the json file\n",
    "\n",
    "filepath = os.path.join('..', 'HeroesOfPymoli', 'purchase_data.json' )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Item ID</th>\n",
       "      <th>Item Name</th>\n",
       "      <th>Price</th>\n",
       "      <th>SN</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>38</td>\n",
       "      <td>Male</td>\n",
       "      <td>165</td>\n",
       "      <td>Bone Crushing Silver Skewer</td>\n",
       "      <td>3.37</td>\n",
       "      <td>Aelalis34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>119</td>\n",
       "      <td>Stormbringer, Dark Blade of Ending Misery</td>\n",
       "      <td>2.32</td>\n",
       "      <td>Eolo46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>34</td>\n",
       "      <td>Male</td>\n",
       "      <td>174</td>\n",
       "      <td>Primitive Blade</td>\n",
       "      <td>2.46</td>\n",
       "      <td>Assastnya25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>92</td>\n",
       "      <td>Final Critic</td>\n",
       "      <td>1.36</td>\n",
       "      <td>Pheusrical25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>23</td>\n",
       "      <td>Male</td>\n",
       "      <td>63</td>\n",
       "      <td>Stormfury Mace</td>\n",
       "      <td>1.27</td>\n",
       "      <td>Aela59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>10</td>\n",
       "      <td>Sleepwalker</td>\n",
       "      <td>1.73</td>\n",
       "      <td>Tanimnya91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>153</td>\n",
       "      <td>Mercenary Sabre</td>\n",
       "      <td>4.57</td>\n",
       "      <td>Undjaskla97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>29</td>\n",
       "      <td>Female</td>\n",
       "      <td>169</td>\n",
       "      <td>Interrogator, Blood Blade of the Queen</td>\n",
       "      <td>3.32</td>\n",
       "      <td>Iathenudil29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>25</td>\n",
       "      <td>Male</td>\n",
       "      <td>118</td>\n",
       "      <td>Ghost Reaver, Longsword of Magic</td>\n",
       "      <td>2.77</td>\n",
       "      <td>Sondenasta63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>31</td>\n",
       "      <td>Male</td>\n",
       "      <td>99</td>\n",
       "      <td>Expiration, Warscythe Of Lost Worlds</td>\n",
       "      <td>4.53</td>\n",
       "      <td>Hilaerin92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>24</td>\n",
       "      <td>Male</td>\n",
       "      <td>57</td>\n",
       "      <td>Despair, Favor of Due Diligence</td>\n",
       "      <td>3.81</td>\n",
       "      <td>Chamosia29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>47</td>\n",
       "      <td>Alpha, Reach of Ending Hope</td>\n",
       "      <td>1.55</td>\n",
       "      <td>Sally64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>30</td>\n",
       "      <td>Male</td>\n",
       "      <td>81</td>\n",
       "      <td>Dreamkiss</td>\n",
       "      <td>4.06</td>\n",
       "      <td>Iskossa88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>23</td>\n",
       "      <td>Male</td>\n",
       "      <td>77</td>\n",
       "      <td>Piety, Guardian of Riddles</td>\n",
       "      <td>3.68</td>\n",
       "      <td>Seorithstilis90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>40</td>\n",
       "      <td>Male</td>\n",
       "      <td>44</td>\n",
       "      <td>Bonecarvin Battle Axe</td>\n",
       "      <td>2.46</td>\n",
       "      <td>Sundast29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>96</td>\n",
       "      <td>Blood-Forged Skeletal Spine</td>\n",
       "      <td>4.77</td>\n",
       "      <td>Haellysu29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>22</td>\n",
       "      <td>Female</td>\n",
       "      <td>123</td>\n",
       "      <td>Twilight's Carver</td>\n",
       "      <td>1.14</td>\n",
       "      <td>Sundista85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>22</td>\n",
       "      <td>Female</td>\n",
       "      <td>59</td>\n",
       "      <td>Lightning, Etcher of the King</td>\n",
       "      <td>1.65</td>\n",
       "      <td>Aenarap34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>28</td>\n",
       "      <td>Male</td>\n",
       "      <td>91</td>\n",
       "      <td>Celeste</td>\n",
       "      <td>3.71</td>\n",
       "      <td>Iskista88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>31</td>\n",
       "      <td>Male</td>\n",
       "      <td>177</td>\n",
       "      <td>Winterthorn, Defender of Shifting Worlds</td>\n",
       "      <td>4.89</td>\n",
       "      <td>Assossa43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>24</td>\n",
       "      <td>Male</td>\n",
       "      <td>78</td>\n",
       "      <td>Glimmer, Ender of the Moon</td>\n",
       "      <td>2.33</td>\n",
       "      <td>Irith83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>15</td>\n",
       "      <td>Male</td>\n",
       "      <td>3</td>\n",
       "      <td>Phantomlight</td>\n",
       "      <td>1.79</td>\n",
       "      <td>Iaralrgue74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>11</td>\n",
       "      <td>Female</td>\n",
       "      <td>11</td>\n",
       "      <td>Brimstone</td>\n",
       "      <td>2.52</td>\n",
       "      <td>Deural48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>19</td>\n",
       "      <td>Male</td>\n",
       "      <td>183</td>\n",
       "      <td>Dragon's Greatsword</td>\n",
       "      <td>2.36</td>\n",
       "      <td>Chanosia65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>11</td>\n",
       "      <td>Male</td>\n",
       "      <td>65</td>\n",
       "      <td>Conqueror Adamantite Mace</td>\n",
       "      <td>1.96</td>\n",
       "      <td>Qarwen67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>63</td>\n",
       "      <td>Stormfury Mace</td>\n",
       "      <td>1.27</td>\n",
       "      <td>Idai61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>29</td>\n",
       "      <td>Male</td>\n",
       "      <td>132</td>\n",
       "      <td>Persuasion</td>\n",
       "      <td>3.90</td>\n",
       "      <td>Aerithllora36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>34</td>\n",
       "      <td>Male</td>\n",
       "      <td>106</td>\n",
       "      <td>Crying Steel Sickle</td>\n",
       "      <td>2.29</td>\n",
       "      <td>Assastnya25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>15</td>\n",
       "      <td>Male</td>\n",
       "      <td>49</td>\n",
       "      <td>The Oculus, Token of Lost Worlds</td>\n",
       "      <td>4.23</td>\n",
       "      <td>Ilariarin45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>16</td>\n",
       "      <td>Female</td>\n",
       "      <td>45</td>\n",
       "      <td>Glinting Glass Edge</td>\n",
       "      <td>2.46</td>\n",
       "      <td>Phaedai25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>750</th>\n",
       "      <td>23</td>\n",
       "      <td>Male</td>\n",
       "      <td>86</td>\n",
       "      <td>Stormfury Lantern</td>\n",
       "      <td>1.28</td>\n",
       "      <td>Eollym91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>751</th>\n",
       "      <td>26</td>\n",
       "      <td>Female</td>\n",
       "      <td>179</td>\n",
       "      <td>Wolf, Promise of the Moonwalker</td>\n",
       "      <td>1.88</td>\n",
       "      <td>Lisjasksda68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>752</th>\n",
       "      <td>15</td>\n",
       "      <td>Female</td>\n",
       "      <td>116</td>\n",
       "      <td>Renewed Skeletal Katana</td>\n",
       "      <td>2.37</td>\n",
       "      <td>Yalostiphos68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>753</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>4</td>\n",
       "      <td>Bloodlord's Fetish</td>\n",
       "      <td>2.28</td>\n",
       "      <td>Thryallym62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>754</th>\n",
       "      <td>31</td>\n",
       "      <td>Male</td>\n",
       "      <td>104</td>\n",
       "      <td>Gladiator's Glaive</td>\n",
       "      <td>1.36</td>\n",
       "      <td>Sondastan54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>755</th>\n",
       "      <td>22</td>\n",
       "      <td>Female</td>\n",
       "      <td>179</td>\n",
       "      <td>Wolf, Promise of the Moonwalker</td>\n",
       "      <td>1.88</td>\n",
       "      <td>Ailaesuir66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>756</th>\n",
       "      <td>22</td>\n",
       "      <td>Male</td>\n",
       "      <td>6</td>\n",
       "      <td>Rusty Skull</td>\n",
       "      <td>1.20</td>\n",
       "      <td>Siasri67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>757</th>\n",
       "      <td>35</td>\n",
       "      <td>Male</td>\n",
       "      <td>11</td>\n",
       "      <td>Brimstone</td>\n",
       "      <td>2.52</td>\n",
       "      <td>Seosri62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>758</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>122</td>\n",
       "      <td>Unending Tyranny</td>\n",
       "      <td>1.21</td>\n",
       "      <td>Ryastycal90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>759</th>\n",
       "      <td>19</td>\n",
       "      <td>Male</td>\n",
       "      <td>87</td>\n",
       "      <td>Deluge, Edge of the West</td>\n",
       "      <td>2.20</td>\n",
       "      <td>Chanirrasta87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>760</th>\n",
       "      <td>29</td>\n",
       "      <td>Male</td>\n",
       "      <td>81</td>\n",
       "      <td>Dreamkiss</td>\n",
       "      <td>4.06</td>\n",
       "      <td>Aerithllora36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>761</th>\n",
       "      <td>28</td>\n",
       "      <td>Male</td>\n",
       "      <td>175</td>\n",
       "      <td>Woeful Adamantite Claymore</td>\n",
       "      <td>1.24</td>\n",
       "      <td>Raeduerin33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>762</th>\n",
       "      <td>36</td>\n",
       "      <td>Male</td>\n",
       "      <td>52</td>\n",
       "      <td>Hatred</td>\n",
       "      <td>4.39</td>\n",
       "      <td>Lisosiast26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>763</th>\n",
       "      <td>27</td>\n",
       "      <td>Other / Non-Disclosed</td>\n",
       "      <td>48</td>\n",
       "      <td>Rage, Legacy of the Lone Victor</td>\n",
       "      <td>4.32</td>\n",
       "      <td>Eurisuru25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>764</th>\n",
       "      <td>25</td>\n",
       "      <td>Male</td>\n",
       "      <td>70</td>\n",
       "      <td>Hope's End</td>\n",
       "      <td>3.89</td>\n",
       "      <td>Assassasda84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>765</th>\n",
       "      <td>15</td>\n",
       "      <td>Male</td>\n",
       "      <td>13</td>\n",
       "      <td>Serenity</td>\n",
       "      <td>1.49</td>\n",
       "      <td>Aerithnucal56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>766</th>\n",
       "      <td>22</td>\n",
       "      <td>Female</td>\n",
       "      <td>84</td>\n",
       "      <td>Arcane Gem</td>\n",
       "      <td>2.23</td>\n",
       "      <td>Nitherian58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>767</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>122</td>\n",
       "      <td>Unending Tyranny</td>\n",
       "      <td>1.21</td>\n",
       "      <td>Hailaphos89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>768</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>158</td>\n",
       "      <td>Darkheart, Butcher of the Champion</td>\n",
       "      <td>3.56</td>\n",
       "      <td>Chamucosda93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>769</th>\n",
       "      <td>24</td>\n",
       "      <td>Male</td>\n",
       "      <td>73</td>\n",
       "      <td>Ritual Mace</td>\n",
       "      <td>3.74</td>\n",
       "      <td>Frichilsasya78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>770</th>\n",
       "      <td>22</td>\n",
       "      <td>Male</td>\n",
       "      <td>141</td>\n",
       "      <td>Persuasion</td>\n",
       "      <td>3.27</td>\n",
       "      <td>Aenasu69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>771</th>\n",
       "      <td>24</td>\n",
       "      <td>Male</td>\n",
       "      <td>25</td>\n",
       "      <td>Hero Cane</td>\n",
       "      <td>1.03</td>\n",
       "      <td>Lassista97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>772</th>\n",
       "      <td>15</td>\n",
       "      <td>Male</td>\n",
       "      <td>31</td>\n",
       "      <td>Trickster</td>\n",
       "      <td>2.07</td>\n",
       "      <td>Sidap51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>773</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>44</td>\n",
       "      <td>Bonecarvin Battle Axe</td>\n",
       "      <td>2.46</td>\n",
       "      <td>Chamadarsda63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>774</th>\n",
       "      <td>24</td>\n",
       "      <td>Male</td>\n",
       "      <td>123</td>\n",
       "      <td>Twilight's Carver</td>\n",
       "      <td>1.14</td>\n",
       "      <td>Lassassast73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>775</th>\n",
       "      <td>22</td>\n",
       "      <td>Male</td>\n",
       "      <td>98</td>\n",
       "      <td>Deadline, Voice Of Subtlety</td>\n",
       "      <td>3.62</td>\n",
       "      <td>Eural50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>776</th>\n",
       "      <td>14</td>\n",
       "      <td>Male</td>\n",
       "      <td>104</td>\n",
       "      <td>Gladiator's Glaive</td>\n",
       "      <td>1.36</td>\n",
       "      <td>Lirtossa78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>777</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>117</td>\n",
       "      <td>Heartstriker, Legacy of the Light</td>\n",
       "      <td>4.15</td>\n",
       "      <td>Tillyrin30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>778</th>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>75</td>\n",
       "      <td>Brutality Ivory Warmace</td>\n",
       "      <td>1.72</td>\n",
       "      <td>Quelaton80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>779</th>\n",
       "      <td>23</td>\n",
       "      <td>Female</td>\n",
       "      <td>107</td>\n",
       "      <td>Splitter, Foe Of Subtlety</td>\n",
       "      <td>3.61</td>\n",
       "      <td>Alim85</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>780 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Age                 Gender  Item ID  \\\n",
       "0     38                   Male      165   \n",
       "1     21                   Male      119   \n",
       "2     34                   Male      174   \n",
       "3     21                   Male       92   \n",
       "4     23                   Male       63   \n",
       "5     20                   Male       10   \n",
       "6     20                   Male      153   \n",
       "7     29                 Female      169   \n",
       "8     25                   Male      118   \n",
       "9     31                   Male       99   \n",
       "10    24                   Male       57   \n",
       "11    20                   Male       47   \n",
       "12    30                   Male       81   \n",
       "13    23                   Male       77   \n",
       "14    40                   Male       44   \n",
       "15    21                   Male       96   \n",
       "16    22                 Female      123   \n",
       "17    22                 Female       59   \n",
       "18    28                   Male       91   \n",
       "19    31                   Male      177   \n",
       "20    24                   Male       78   \n",
       "21    15                   Male        3   \n",
       "22    11                 Female       11   \n",
       "23    19                   Male      183   \n",
       "24    11                   Male       65   \n",
       "25    21                   Male       63   \n",
       "26    29                   Male      132   \n",
       "27    34                   Male      106   \n",
       "28    15                   Male       49   \n",
       "29    16                 Female       45   \n",
       "..   ...                    ...      ...   \n",
       "750   23                   Male       86   \n",
       "751   26                 Female      179   \n",
       "752   15                 Female      116   \n",
       "753   20                   Male        4   \n",
       "754   31                   Male      104   \n",
       "755   22                 Female      179   \n",
       "756   22                   Male        6   \n",
       "757   35                   Male       11   \n",
       "758   20                   Male      122   \n",
       "759   19                   Male       87   \n",
       "760   29                   Male       81   \n",
       "761   28                   Male      175   \n",
       "762   36                   Male       52   \n",
       "763   27  Other / Non-Disclosed       48   \n",
       "764   25                   Male       70   \n",
       "765   15                   Male       13   \n",
       "766   22                 Female       84   \n",
       "767   20                   Male      122   \n",
       "768   21                   Male      158   \n",
       "769   24                   Male       73   \n",
       "770   22                   Male      141   \n",
       "771   24                   Male       25   \n",
       "772   15                   Male       31   \n",
       "773   21                   Male       44   \n",
       "774   24                   Male      123   \n",
       "775   22                   Male       98   \n",
       "776   14                   Male      104   \n",
       "777   20                   Male      117   \n",
       "778   20                   Male       75   \n",
       "779   23                 Female      107   \n",
       "\n",
       "                                     Item Name  Price               SN  \n",
       "0                  Bone Crushing Silver Skewer   3.37        Aelalis34  \n",
       "1    Stormbringer, Dark Blade of Ending Misery   2.32           Eolo46  \n",
       "2                              Primitive Blade   2.46      Assastnya25  \n",
       "3                                 Final Critic   1.36     Pheusrical25  \n",
       "4                               Stormfury Mace   1.27           Aela59  \n",
       "5                                  Sleepwalker   1.73       Tanimnya91  \n",
       "6                              Mercenary Sabre   4.57      Undjaskla97  \n",
       "7       Interrogator, Blood Blade of the Queen   3.32     Iathenudil29  \n",
       "8             Ghost Reaver, Longsword of Magic   2.77     Sondenasta63  \n",
       "9         Expiration, Warscythe Of Lost Worlds   4.53       Hilaerin92  \n",
       "10             Despair, Favor of Due Diligence   3.81       Chamosia29  \n",
       "11                 Alpha, Reach of Ending Hope   1.55          Sally64  \n",
       "12                                   Dreamkiss   4.06        Iskossa88  \n",
       "13                  Piety, Guardian of Riddles   3.68  Seorithstilis90  \n",
       "14                       Bonecarvin Battle Axe   2.46        Sundast29  \n",
       "15                 Blood-Forged Skeletal Spine   4.77       Haellysu29  \n",
       "16                           Twilight's Carver   1.14       Sundista85  \n",
       "17               Lightning, Etcher of the King   1.65        Aenarap34  \n",
       "18                                     Celeste   3.71        Iskista88  \n",
       "19    Winterthorn, Defender of Shifting Worlds   4.89        Assossa43  \n",
       "20                  Glimmer, Ender of the Moon   2.33          Irith83  \n",
       "21                                Phantomlight   1.79      Iaralrgue74  \n",
       "22                                   Brimstone   2.52         Deural48  \n",
       "23                         Dragon's Greatsword   2.36       Chanosia65  \n",
       "24                   Conqueror Adamantite Mace   1.96         Qarwen67  \n",
       "25                              Stormfury Mace   1.27           Idai61  \n",
       "26                                  Persuasion   3.90    Aerithllora36  \n",
       "27                         Crying Steel Sickle   2.29      Assastnya25  \n",
       "28            The Oculus, Token of Lost Worlds   4.23      Ilariarin45  \n",
       "29                         Glinting Glass Edge   2.46        Phaedai25  \n",
       "..                                         ...    ...              ...  \n",
       "750                          Stormfury Lantern   1.28         Eollym91  \n",
       "751            Wolf, Promise of the Moonwalker   1.88     Lisjasksda68  \n",
       "752                    Renewed Skeletal Katana   2.37    Yalostiphos68  \n",
       "753                         Bloodlord's Fetish   2.28      Thryallym62  \n",
       "754                         Gladiator's Glaive   1.36      Sondastan54  \n",
       "755            Wolf, Promise of the Moonwalker   1.88      Ailaesuir66  \n",
       "756                                Rusty Skull   1.20         Siasri67  \n",
       "757                                  Brimstone   2.52         Seosri62  \n",
       "758                           Unending Tyranny   1.21      Ryastycal90  \n",
       "759                   Deluge, Edge of the West   2.20    Chanirrasta87  \n",
       "760                                  Dreamkiss   4.06    Aerithllora36  \n",
       "761                 Woeful Adamantite Claymore   1.24      Raeduerin33  \n",
       "762                                     Hatred   4.39      Lisosiast26  \n",
       "763            Rage, Legacy of the Lone Victor   4.32       Eurisuru25  \n",
       "764                                 Hope's End   3.89     Assassasda84  \n",
       "765                                   Serenity   1.49    Aerithnucal56  \n",
       "766                                 Arcane Gem   2.23      Nitherian58  \n",
       "767                           Unending Tyranny   1.21      Hailaphos89  \n",
       "768         Darkheart, Butcher of the Champion   3.56     Chamucosda93  \n",
       "769                                Ritual Mace   3.74   Frichilsasya78  \n",
       "770                                 Persuasion   3.27         Aenasu69  \n",
       "771                                  Hero Cane   1.03       Lassista97  \n",
       "772                                  Trickster   2.07          Sidap51  \n",
       "773                      Bonecarvin Battle Axe   2.46    Chamadarsda63  \n",
       "774                          Twilight's Carver   1.14     Lassassast73  \n",
       "775                Deadline, Voice Of Subtlety   3.62          Eural50  \n",
       "776                         Gladiator's Glaive   1.36       Lirtossa78  \n",
       "777          Heartstriker, Legacy of the Light   4.15       Tillyrin30  \n",
       "778                    Brutality Ivory Warmace   1.72       Quelaton80  \n",
       "779                  Splitter, Foe Of Subtlety   3.61           Alim85  \n",
       "\n",
       "[780 rows x 6 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purch_data = pd.read_json(filepath)\n",
    "purch_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Age          780\n",
       "Gender       780\n",
       "Item ID      780\n",
       "Item Name    780\n",
       "Price        780\n",
       "SN           780\n",
       "dtype: int64"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Remove the rows with missing data\n",
    "\n",
    "purch_data = purch_data.dropna(how=\"any\")\n",
    "purch_data.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Age          0\n",
       "Gender       0\n",
       "Item ID      0\n",
       "Item Name    0\n",
       "Price        0\n",
       "SN           0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check to see if there are any rows with missing data\n",
    "purch_data .isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(780, 6)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purch_data .shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Item ID</th>\n",
       "      <th>Item Name</th>\n",
       "      <th>Price</th>\n",
       "      <th>SN</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>38</td>\n",
       "      <td>Male</td>\n",
       "      <td>165</td>\n",
       "      <td>Bone Crushing Silver Skewer</td>\n",
       "      <td>3.37</td>\n",
       "      <td>Aelalis34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>119</td>\n",
       "      <td>Stormbringer, Dark Blade of Ending Misery</td>\n",
       "      <td>2.32</td>\n",
       "      <td>Eolo46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>34</td>\n",
       "      <td>Male</td>\n",
       "      <td>174</td>\n",
       "      <td>Primitive Blade</td>\n",
       "      <td>2.46</td>\n",
       "      <td>Assastnya25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>92</td>\n",
       "      <td>Final Critic</td>\n",
       "      <td>1.36</td>\n",
       "      <td>Pheusrical25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>23</td>\n",
       "      <td>Male</td>\n",
       "      <td>63</td>\n",
       "      <td>Stormfury Mace</td>\n",
       "      <td>1.27</td>\n",
       "      <td>Aela59</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Age Gender  Item ID                                  Item Name  Price  \\\n",
       "0   38   Male      165                Bone Crushing Silver Skewer   3.37   \n",
       "1   21   Male      119  Stormbringer, Dark Blade of Ending Misery   2.32   \n",
       "2   34   Male      174                            Primitive Blade   2.46   \n",
       "3   21   Male       92                               Final Critic   1.36   \n",
       "4   23   Male       63                             Stormfury Mace   1.27   \n",
       "\n",
       "             SN  \n",
       "0     Aelalis34  \n",
       "1        Eolo46  \n",
       "2   Assastnya25  \n",
       "3  Pheusrical25  \n",
       "4        Aela59  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purch_data = pd.DataFrame(purch_data)\n",
    "purch_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Item ID</th>\n",
       "      <th>Price</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>780.000000</td>\n",
       "      <td>780.000000</td>\n",
       "      <td>780.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>22.729487</td>\n",
       "      <td>91.293590</td>\n",
       "      <td>2.931192</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>6.930604</td>\n",
       "      <td>52.707537</td>\n",
       "      <td>1.115780</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>7.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.030000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>19.000000</td>\n",
       "      <td>44.000000</td>\n",
       "      <td>1.960000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>22.000000</td>\n",
       "      <td>91.000000</td>\n",
       "      <td>2.880000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>25.000000</td>\n",
       "      <td>135.000000</td>\n",
       "      <td>3.910000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>45.000000</td>\n",
       "      <td>183.000000</td>\n",
       "      <td>4.950000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Age     Item ID       Price\n",
       "count  780.000000  780.000000  780.000000\n",
       "mean    22.729487   91.293590    2.931192\n",
       "std      6.930604   52.707537    1.115780\n",
       "min      7.000000    0.000000    1.030000\n",
       "25%     19.000000   44.000000    1.960000\n",
       "50%     22.000000   91.000000    2.880000\n",
       "75%     25.000000  135.000000    3.910000\n",
       "max     45.000000  183.000000    4.950000"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purch_data.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Age            int64\n",
       "Gender        object\n",
       "Item ID        int64\n",
       "Item Name     object\n",
       "Price        float64\n",
       "SN            object\n",
       "dtype: object"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "purch_data.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total Players</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>573</th>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: []\n",
       "Index: [573]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Player Count\n",
    "player_count = len(purch_data['SN'].unique())\n",
    "\n",
    "players_data = pd.DataFrame([{'Total Players': player_count}])\n",
    "\n",
    "players_data.set_index('Total Players', inplace = True)\n",
    "players_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Average Purchase Price</th> \n",
       "        <th class=\"col_heading level0 col1\" >Number of Unique Items</th> \n",
       "        <th class=\"col_heading level0 col2\" >Total Purchases</th> \n",
       "        <th class=\"col_heading level0 col3\" >Total Revenue</th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >0</th> \n",
       "        <td id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >$2.93</td> \n",
       "        <td id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >183</td> \n",
       "        <td id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >780</td> \n",
       "        <td id=\"T_b874db2e_c3d2_11e7_8ff5_a0afbd9ac224row0_col3\" class=\"data row0 col3\" >$2,286.33</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b344a6a0>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "# Purchasing Analysis (Total)\n",
    "\n",
    "# Number of Unique Items\n",
    "# Average Purchase Price\n",
    "# Total Number of Purchases\n",
    "# Total Revenue\n",
    "\n",
    "num_items = purch_data.drop_duplicates(['Item ID'], keep = 'last')\n",
    "total_unique = len(num_items)\n",
    "total_purch = purch_data['Price'].count()\n",
    "total_rev = round(purch_data['Price'].sum(),2)\n",
    "avg_price = round(total_rev/total_purch, 2)\n",
    "\n",
    "purch_analysis = pd.DataFrame([{\n",
    "    \n",
    "    \"Number of Unique Items\": total_unique,\n",
    "    'Average Purchase Price': avg_price,\n",
    "    'Total Purchases': total_purch,\n",
    "    'Total Revenue': total_rev\n",
    "}])\n",
    "\n",
    "\n",
    "purch_analysis.style.format({'Average Purchase Price': '${:.2f}', 'Total Revenue': '${:,.2f}'})\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Numb of Players</th> \n",
       "        <th class=\"col_heading level0 col1\" >Percent of Players</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >Gender</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >Male</th> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >465</td> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >81.2%</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >Female</th> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >100</td> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >17.5%</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >Other / Non-Disclosed</th> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >8</td> \n",
       "        <td id=\"T_c07bb434_c3d2_11e7_a069_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >1.4%</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3e15a20>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Gender Demographics\n",
    "\n",
    "# Percentage and Count of Male Players\n",
    "# Percentage and Count of Female Players\n",
    "# Percentage and Count of Other / Non-Disclosed\n",
    "\n",
    "num_players = purch_data.drop_duplicates(['SN'], keep ='last')\n",
    "gender_counts = num_players['Gender'].value_counts().reset_index()\n",
    "gender_counts['Percent of Players'] = gender_counts['Gender']/player_count * 100\n",
    "gender_counts.rename(columns = {'index': 'Gender', 'Gender': 'Numb of Players'}, inplace = True) \n",
    "gender_counts.set_index(['Gender'], inplace = True)\n",
    "\n",
    "gender_counts.style.format({\"Percent of Players\": \"{:.1f}%\"})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Numb of Purchases</th> \n",
       "        <th class=\"col_heading level0 col1\" >Total Purchase Value</th> \n",
       "        <th class=\"col_heading level0 col2\" >Average Purchase Price</th> \n",
       "        <th class=\"col_heading level0 col3\" >Normalized Totals</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >Gender</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >Female</th> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >136</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >$382.91</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >$2.82</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row0_col3\" class=\"data row0 col3\" >$3.83</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >Male</th> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >633</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >$1867.68</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row1_col2\" class=\"data row1 col2\" >$2.95</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row1_col3\" class=\"data row1 col3\" >$4.02</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >Other / Non-Disclosed</th> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >11</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >$35.74</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row2_col2\" class=\"data row2 col2\" >$3.25</td> \n",
       "        <td id=\"T_0a97077e_c3d3_11e7_865e_a0afbd9ac224row2_col3\" class=\"data row2 col3\" >$4.47</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3de6eb8>"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Purchasing Analysis (Gender)\n",
    "\n",
    "# The below each broken by gender\n",
    "# Purchase Count\n",
    "# Average Purchase Price\n",
    "# Total Purchase Value\n",
    "# Normalized Totals\n",
    "\n",
    "purch_count_gen = pd.DataFrame(purch_data.groupby('Gender')['Gender'].count())\n",
    "\n",
    "total_purch_gen = pd.DataFrame(purch_data.groupby('Gender')['Price'].sum())\n",
    "purch_analysis_gen = pd.merge(purch_count_gen, total_purch_gen, left_index = True, right_index = True)\n",
    "purch_analysis_gen.rename(columns = {'Gender': 'Numb of Purchases', 'Price':'Total Purchase Value'}, inplace=True)\n",
    "purch_analysis_gen['Average Purchase Price'] = purch_analysis_gen['Total Purchase Value']/purch_analysis_gen['Numb of Purchases']\n",
    "purch_analysis_gen = purch_analysis_gen.merge(gender_counts, left_index = True, right_index = True)\n",
    "purch_analysis_gen['Normalized Totals'] = purch_analysis_gen['Total Purchase Value']/purch_analysis_gen['Numb of Players']\n",
    "purch_analysis_gen\n",
    "\n",
    "del purch_analysis_gen['Percent of Players']\n",
    "del purch_analysis_gen['Numb of Players']\n",
    "\n",
    "purch_analysis_gen.style.format({'Total Purchase Value': '${:.2f}', 'Average Purchase Price': '${:.2f}', 'Normalized Totals': '${:.2f}'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Numb of Purchases</th> \n",
       "        <th class=\"col_heading level0 col1\" >Average Purchase Price</th> \n",
       "        <th class=\"col_heading level0 col2\" >Total Purchase Value</th> \n",
       "        <th class=\"col_heading level0 col3\" >Numb of Purchasers</th> \n",
       "        <th class=\"col_heading level0 col4\" >Normalized Totals</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >Age</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >10 - 14</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >35</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >$2.77</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >$96.95</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row0_col3\" class=\"data row0 col3\" >23</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row0_col4\" class=\"data row0 col4\" >$4.22</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >15 - 19</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >133</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >$2.91</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row1_col2\" class=\"data row1 col2\" >$386.42</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row1_col3\" class=\"data row1 col3\" >100</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row1_col4\" class=\"data row1 col4\" >$3.86</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >20 - 24</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >336</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >$2.91</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row2_col2\" class=\"data row2 col2\" >$978.77</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row2_col3\" class=\"data row2 col3\" >259</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row2_col4\" class=\"data row2 col4\" >$3.78</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row3\" class=\"row_heading level0 row3\" >25 - 29</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row3_col0\" class=\"data row3 col0\" >125</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row3_col1\" class=\"data row3 col1\" >$2.96</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row3_col2\" class=\"data row3 col2\" >$370.33</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row3_col3\" class=\"data row3 col3\" >87</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row3_col4\" class=\"data row3 col4\" >$4.26</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row4\" class=\"row_heading level0 row4\" >30 - 34</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row4_col0\" class=\"data row4 col0\" >64</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row4_col1\" class=\"data row4 col1\" >$3.08</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row4_col2\" class=\"data row4 col2\" >$197.25</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row4_col3\" class=\"data row4 col3\" >47</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row4_col4\" class=\"data row4 col4\" >$4.20</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row5\" class=\"row_heading level0 row5\" >35 - 39</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row5_col0\" class=\"data row5 col0\" >42</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row5_col1\" class=\"data row5 col1\" >$2.84</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row5_col2\" class=\"data row5 col2\" >$119.40</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row5_col3\" class=\"data row5 col3\" >27</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row5_col4\" class=\"data row5 col4\" >$4.42</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row6\" class=\"row_heading level0 row6\" >< 10</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row6_col0\" class=\"data row6 col0\" >28</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row6_col1\" class=\"data row6 col1\" >$2.98</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row6_col2\" class=\"data row6 col2\" >$83.46</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row6_col3\" class=\"data row6 col3\" >19</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row6_col4\" class=\"data row6 col4\" >$4.39</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224level0_row7\" class=\"row_heading level0 row7\" >> 40</th> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row7_col0\" class=\"data row7 col0\" >17</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row7_col1\" class=\"data row7 col1\" >$3.16</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row7_col2\" class=\"data row7 col2\" >$53.75</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row7_col3\" class=\"data row7 col3\" >11</td> \n",
       "        <td id=\"T_0ed56598_c3d3_11e7_8a5f_a0afbd9ac224row7_col4\" class=\"data row7 col4\" >$4.89</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3ed7eb8>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Age Demographics\n",
    "\n",
    "# The below each broken into bins of 4 years (i.e. &lt;10, 10-14, 15-19, etc.) \n",
    "# Purchase Count\n",
    "# Average Purchase Price\n",
    "# Total Purchase Value\n",
    "# Normalized Totals\n",
    "\n",
    "\n",
    "purch_data.loc[(purch_data['Age'] < 10), 'age'] = \"< 10\"\n",
    "purch_data.loc[(purch_data['Age'] >= 10) & (purch_data['Age'] <= 14), 'age'] = \"10 - 14\"\n",
    "purch_data.loc[(purch_data['Age'] >= 15) & (purch_data['Age'] <= 19), 'age'] = \"15 - 19\"\n",
    "purch_data.loc[(purch_data['Age'] >= 20) & (purch_data['Age'] <= 24), 'age'] = \"20 - 24\"\n",
    "purch_data.loc[(purch_data['Age'] >= 25) & (purch_data['Age'] <= 29), 'age'] = \"25 - 29\"\n",
    "purch_data.loc[(purch_data['Age'] >= 30) & (purch_data['Age'] <= 34), 'age'] = \"30 - 34\"\n",
    "purch_data.loc[(purch_data['Age'] >= 35) & (purch_data['Age'] <= 39), 'age'] = \"35 - 39\"\n",
    "purch_data.loc[(purch_data['Age'] >= 40), 'age'] = \"> 40\"\n",
    "#purch_data[['age', 'Age']].count()\n",
    "\n",
    "\n",
    "purch_count_age = pd.DataFrame(purch_data.groupby('age')['SN'].count())\n",
    "\n",
    "avg_price_age = pd.DataFrame(purch_data.groupby('age')['Price'].mean())\n",
    "\n",
    "tot_purch_age = pd.DataFrame(purch_data.groupby('age')['Price'].sum())\n",
    "\n",
    "no_dup_age = pd.DataFrame(purch_data.drop_duplicates('SN', keep = 'last').groupby('age')['SN'].count())\n",
    "\n",
    "merge_age = pd.merge(purch_count_age, avg_price_age, left_index = True, right_index = True).merge(tot_purch_age, left_index = True, right_index = True).merge(no_dup_age, left_index = True, right_index = True)\n",
    "merge_age.rename(columns = {\"SN_x\": \"Numb of Purchases\", \"Price_x\": \"Average Purchase Price\", \"Price_y\": \"Total Purchase Value\", \"SN_y\": \"Numb of Purchasers\"}, inplace = True)\n",
    "merge_age['Normalized Totals'] = merge_age['Total Purchase Value']/merge_age['Numb of Purchasers']\n",
    "merge_age.index.rename(\"Age\", inplace = True)\n",
    "merge_age.style.format({'Average Purchase Price': '${:.2f}', 'Total Purchase Value': '${:.2f}', 'Normalized Totals': '${:.2f}'})\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Total Purchase Value</th> \n",
       "        <th class=\"col_heading level0 col1\" >Purchase Count</th> \n",
       "        <th class=\"col_heading level0 col2\" >Average Purchase Price</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >SN</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >Undirrala66</th> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >$17.06</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >5</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >$3.41</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >Saedue76</th> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >$13.56</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >4</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row1_col2\" class=\"data row1 col2\" >$3.39</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >Mindimnya67</th> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >$12.74</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >4</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row2_col2\" class=\"data row2 col2\" >$3.18</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224level0_row3\" class=\"row_heading level0 row3\" >Haellysu29</th> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row3_col0\" class=\"data row3 col0\" >$12.73</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row3_col1\" class=\"data row3 col1\" >3</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row3_col2\" class=\"data row3 col2\" >$4.24</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224level0_row4\" class=\"row_heading level0 row4\" >Eoda93</th> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row4_col0\" class=\"data row4 col0\" >$11.58</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row4_col1\" class=\"data row4 col1\" >3</td> \n",
       "        <td id=\"T_139cdc06_c3d3_11e7_8991_a0afbd9ac224row4_col2\" class=\"data row4 col2\" >$3.86</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3ec5f60>"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Top Spenders\n",
    "\n",
    "# Identify the the top 5 spenders in the game by total purchase value, then list (in a table):\n",
    "# SN\n",
    "# Purchase Count\n",
    "# Average Purchase Price\n",
    "# Total Purchase Value\n",
    "\n",
    "\n",
    "purchase_amt_SN = pd.DataFrame(purch_data.groupby('SN')['Price'].sum())\n",
    "num_purchase_SN = pd.DataFrame(purch_data.groupby('SN')['Price'].count())\n",
    "avg_purchase_SN = pd.DataFrame(purch_data.groupby('SN')['Price'].mean())\n",
    "\n",
    "merged_top5 = pd.merge(purchase_amt_SN, num_purchase_SN, left_index = True, right_index = True).merge(avg_purchase_SN, left_index=True, right_index=True)\n",
    "merged_top5.rename(columns = {'Price_x': 'Total Purchase Value', 'Price_y':'Purchase Count', 'Price':'Average Purchase Price'}, inplace = True)\n",
    "merged_top5.sort_values('Total Purchase Value', ascending = False, inplace=True)\n",
    "merged_top5 = merged_top5.head()\n",
    "merged_top5.style.format({'Total Purchase Value': '${:.2f}', 'Average Purchase Price': '${:.2f}'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Item Name</th> \n",
       "        <th class=\"col_heading level0 col1\" >Purchase Count</th> \n",
       "        <th class=\"col_heading level0 col2\" >Item Price</th> \n",
       "        <th class=\"col_heading level0 col3\" >Total Purchase Value</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >Item ID</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >39</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >Betrayal, Whisper of Grieving Widows</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >11</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >$2.35</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row0_col3\" class=\"data row0 col3\" >$25.85</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >84</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >Arcane Gem</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >11</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row1_col2\" class=\"data row1 col2\" >$2.23</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row1_col3\" class=\"data row1 col3\" >$24.53</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >31</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >Trickster</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >9</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row2_col2\" class=\"data row2 col2\" >$2.07</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row2_col3\" class=\"data row2 col3\" >$18.63</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row3\" class=\"row_heading level0 row3\" >175</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row3_col0\" class=\"data row3 col0\" >Woeful Adamantite Claymore</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row3_col1\" class=\"data row3 col1\" >9</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row3_col2\" class=\"data row3 col2\" >$1.24</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row3_col3\" class=\"data row3 col3\" >$11.16</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row4\" class=\"row_heading level0 row4\" >13</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row4_col0\" class=\"data row4 col0\" >Serenity</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row4_col1\" class=\"data row4 col1\" >9</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row4_col2\" class=\"data row4 col2\" >$1.49</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row4_col3\" class=\"data row4 col3\" >$13.41</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224level0_row5\" class=\"row_heading level0 row5\" >34</th> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row5_col0\" class=\"data row5 col0\" >Retribution Axe</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row5_col1\" class=\"data row5 col1\" >9</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row5_col2\" class=\"data row5 col2\" >$4.14</td> \n",
       "        <td id=\"T_17f2bf0c_c3d3_11e7_9297_a0afbd9ac224row5_col3\" class=\"data row5 col3\" >$37.26</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3eaf080>"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Most Popular Items\n",
    "\n",
    "# Identify the 5 most popular items by purchase count, then list (in a table):\n",
    "# Item ID\n",
    "# Item Name\n",
    "# Purchase Count\n",
    "# Item Price\n",
    "# Total Purchase Value\n",
    "\n",
    "\n",
    "top5_items_ID = pd.DataFrame(purch_data.groupby('Item ID')['Item ID'].count())\n",
    "\n",
    "top5_items_ID.sort_values('Item ID', ascending = False, inplace = True)\n",
    "\n",
    "top5_items_ID = top5_items_ID.iloc[0:6][:]\n",
    "\n",
    "top5_items_total = pd.DataFrame(purch_data.groupby('Item ID')['Price'].sum())\n",
    "\n",
    "top5_items = pd.merge(top5_items_ID, top5_items_total, left_index = True, right_index = True)\n",
    "\n",
    "no_dup_items = purch_data.drop_duplicates(['Item ID'], keep = 'last')\n",
    "\n",
    "top5_merge_ID = pd.merge(top5_items, no_dup_items, left_index = True, right_on = 'Item ID')\n",
    "\n",
    "top5_merge_ID = top5_merge_ID[['Item ID', 'Item Name', 'Item ID_x', 'Price_y', 'Price_x']]\n",
    "\n",
    "top5_merge_ID.set_index(['Item ID'], inplace = True)\n",
    "\n",
    "top5_merge_ID.rename(columns =  {'Item ID_x': 'Purchase Count', 'Price_y': 'Item Price', 'Price_x': 'Total Purchase Value'}, inplace=True)\n",
    "\n",
    "top5_merge_ID.style.format({'Item Price': '${:.2f}', 'Total Purchase Value': '${:.2f}'})\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "</style>  \n",
       "<table id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224\" > \n",
       "<thead>    <tr> \n",
       "        <th class=\"blank level0\" ></th> \n",
       "        <th class=\"col_heading level0 col0\" >Item Name</th> \n",
       "        <th class=\"col_heading level0 col1\" >Purchase Count</th> \n",
       "        <th class=\"col_heading level0 col2\" >Item Price</th> \n",
       "        <th class=\"col_heading level0 col3\" >Total Purchase Value</th> \n",
       "    </tr>    <tr> \n",
       "        <th class=\"index_name level0\" >Item ID</th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "        <th class=\"blank\" ></th> \n",
       "    </tr></thead> \n",
       "<tbody>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row0\" class=\"row_heading level0 row0\" >39</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row0_col0\" class=\"data row0 col0\" >Betrayal, Whisper of Grieving Widows</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row0_col1\" class=\"data row0 col1\" >11</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row0_col2\" class=\"data row0 col2\" >$2.35</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row0_col3\" class=\"data row0 col3\" >$25.85</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row1\" class=\"row_heading level0 row1\" >84</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row1_col0\" class=\"data row1 col0\" >Arcane Gem</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row1_col1\" class=\"data row1 col1\" >11</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row1_col2\" class=\"data row1 col2\" >$2.23</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row1_col3\" class=\"data row1 col3\" >$24.53</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row2\" class=\"row_heading level0 row2\" >31</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row2_col0\" class=\"data row2 col0\" >Trickster</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row2_col1\" class=\"data row2 col1\" >9</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row2_col2\" class=\"data row2 col2\" >$2.07</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row2_col3\" class=\"data row2 col3\" >$18.63</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row3\" class=\"row_heading level0 row3\" >175</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row3_col0\" class=\"data row3 col0\" >Woeful Adamantite Claymore</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row3_col1\" class=\"data row3 col1\" >9</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row3_col2\" class=\"data row3 col2\" >$1.24</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row3_col3\" class=\"data row3 col3\" >$11.16</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row4\" class=\"row_heading level0 row4\" >13</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row4_col0\" class=\"data row4 col0\" >Serenity</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row4_col1\" class=\"data row4 col1\" >9</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row4_col2\" class=\"data row4 col2\" >$1.49</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row4_col3\" class=\"data row4 col3\" >$13.41</td> \n",
       "    </tr>    <tr> \n",
       "        <th id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224level0_row5\" class=\"row_heading level0 row5\" >34</th> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row5_col0\" class=\"data row5 col0\" >Retribution Axe</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row5_col1\" class=\"data row5 col1\" >9</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row5_col2\" class=\"data row5 col2\" >$4.14</td> \n",
       "        <td id=\"T_1a4bb98c_c3d3_11e7_a0a1_a0afbd9ac224row5_col3\" class=\"data row5 col3\" >$37.26</td> \n",
       "    </tr></tbody> \n",
       "</table> "
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x180b3ec7e80>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Most Profitable Items\n",
    "\n",
    "# Identify the 5 most profitable items by total purchase value, then list (in a table):\n",
    "# Item ID\n",
    "# Item Name\n",
    "# Purchase Count\n",
    "# Item Price\n",
    "# Total Purchase Value\n",
    "\n",
    "\n",
    "top5_items_ID = pd.DataFrame(purch_data.groupby('Item ID')['Item ID'].count())\n",
    "\n",
    "top5_items_ID.sort_values('Item ID', ascending = False, inplace = True)\n",
    "\n",
    "top5_items_ID = top5_items_ID.iloc[0:6][:]\n",
    "\n",
    "top5_items_total = pd.DataFrame(purch_data.groupby('Item ID')['Price'].sum())\n",
    " \n",
    "top5_items = pd.merge(top5_items_ID, top5_items_total, left_index = True, right_index = True)\n",
    "\n",
    "no_dup_items = purch_data.drop_duplicates(['Item ID'], keep = 'last')\n",
    "\n",
    "top5_merge_ID = pd.merge(top5_items, no_dup_items, left_index = True, right_on = 'Item ID')\n",
    "\n",
    "top5_merge_ID = top5_merge_ID[['Item ID', 'Item Name', 'Item ID_x', 'Price_y', 'Price_x']]\n",
    "\n",
    "top5_merge_ID.set_index(['Item ID'], inplace = True)\n",
    "\n",
    "top5_merge_ID.rename(columns =  {'Item ID_x': 'Purchase Count', 'Price_y': 'Item Price', 'Price_x': 'Total Purchase Value'}, inplace=True)\n",
    "\n",
    "top5_merge_ID.style.format({'Item Price': '${:.2f}', 'Total Purchase Value': '${:.2f}'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
